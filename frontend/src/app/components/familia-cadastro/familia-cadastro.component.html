<section class="cadastro">
  <h2>Cadastro de Família</h2>
  <nav class="tabs">
    <button *ngFor="let tab of tabs" [class.active]="activeTab === tab.id" (click)="changeTab(tab.id)">{{ tab.label }}</button>
  </nav>

  <form [formGroup]="form" (ngSubmit)="submit()">
    <div *ngIf="feedback" class="feedback">{{ feedback }}</div>

    <div class="tab-content" *ngIf="activeTab === 'familia'" formGroupName="familia">
      <label>Nome da família*<input formControlName="nome_familia" /></label>
      <label>Referência familiar (ID do beneficiário)<input formControlName="id_referencia_familiar" /></label>
      <label>Arranjo familiar<select formControlName="arranjo_familiar">
          <option value=""></option>
          <option value="NUCLEAR">Nuclear</option>
          <option value="MONOPARENTAL">Monoparental</option>
          <option value="EXTENSA">Extensa</option>
          <option value="RECONSTITUIDA">Reconstituída</option>
          <option value="OUTRO">Outro</option>
        </select></label>
    </div>

    <div class="tab-content" *ngIf="activeTab === 'endereco'" formGroupName="endereco">
      <label>CEP<input formControlName="cep" /></label>
      <label>Logradouro<input formControlName="logradouro" /></label>
      <label>Número<input formControlName="numero" /></label>
      <label>Complemento<input formControlName="complemento" /></label>
      <label>Bairro<input formControlName="bairro" /></label>
      <label>Ponto de referência<input formControlName="ponto_referencia" /></label>
      <label>Município<input formControlName="municipio" /></label>
      <label>UF<input maxlength="2" formControlName="uf" /></label>
      <label>Zona<select formControlName="zona"><option value=""></option><option value="URBANA">Urbana</option><option value="RURAL">Rural</option></select></label>
      <label>Situação do imóvel<input formControlName="situacao_imovel" /></label>
      <label>Tipo de moradia<input formControlName="tipo_moradia" /></label>
      <label><input type="checkbox" formControlName="agua_encanada" /> Água encanada</label>
      <label>Esgoto<select formControlName="esgoto_tipo"><option value=""></option><option value="REDE">Rede</option><option value="FOSSA">Fossa</option><option value="CEU_ABERTO">Céu aberto</option><option value="NAO_POSSUI">Não possui</option></select></label>
      <label>Coleta de lixo<select formControlName="coleta_lixo"><option value=""></option><option value="REGULAR">Regular</option><option value="IRREGULAR">Irregular</option><option value="NAO_POSSUI">Não possui</option></select></label>
      <label><input type="checkbox" formControlName="energia_eletrica" /> Energia elétrica</label>
      <label><input type="checkbox" formControlName="internet" /> Internet</label>
    </div>

    <div class="tab-content" *ngIf="activeTab === 'membros'">
      <div class="membros-header">
        <button type="button" (click)="addMembro()">Adicionar membro</button>
      </div>
      <div class="membro" *ngFor="let membro of membros.controls; let i = index" [formGroupName]="i">
        <label>Beneficiário (ID)<input formControlName="id_beneficiario" /></label>
        <label>Parentesco<input formControlName="parentesco" /></label>
        <label><input type="checkbox" formControlName="responsavel_familiar" /> Responsável familiar</label>
        <label><input type="checkbox" formControlName="contribui_renda" /> Contribui renda</label>
        <label>Renda individual<input type="number" formControlName="renda_individual" /></label>
        <label><input type="checkbox" formControlName="participa_servicos" /> Participa de serviços</label>
        <label>Observações<textarea formControlName="observacoes"></textarea></label>
        <button type="button" (click)="removeMembro(i)">Remover</button>
      </div>
    </div>

    <div class="tab-content" *ngIf="activeTab === 'renda'" formGroupName="renda">
      <label>Renda familiar total<input formControlName="renda_familiar_total" /></label>
      <label>Renda per capita<input formControlName="renda_per_capita" /></label>
      <label>Principais fontes de renda<textarea formControlName="principais_fontes_renda"></textarea></label>
      <label>Situação de insegurança alimentar<select formControlName="situacao_inseguranca_alimentar">
          <option value=""></option>
          <option value="NAO_APRESENTA">Não apresenta</option>
          <option value="MODERADA">Moderada</option>
          <option value="GRAVE">Grave</option>
        </select></label>
      <label><input type="checkbox" formControlName="possui_dividas_relevantes" /> Possui dívidas relevantes</label>
      <label>Descrição das dívidas<textarea formControlName="descricao_dividas"></textarea></label>
    </div>

    <div class="tab-content" *ngIf="activeTab === 'vulnerabilidades'" formGroupName="vulnerabilidades">
      <label>Vulnerabilidades<textarea formControlName="vulnerabilidades_familia"></textarea></label>
      <label>Serviços de acompanhamento<textarea formControlName="servicos_acompanhamento"></textarea></label>
      <label>Técnico responsável<input formControlName="tecnico_responsavel" /></label>
      <label>Periodicidade<input formControlName="periodicidade_atendimento" /></label>
      <label>Próxima visita<input type="date" formControlName="proxima_visita_prevista" /></label>
      <label>Observações<textarea formControlName="observacoes"></textarea></label>
    </div>

    <div class="actions">
      <button type="submit" [disabled]="saving">Salvar</button>
    </div>
  </form>
</section>
