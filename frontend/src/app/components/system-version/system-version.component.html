<app-tela-padrao [fullWidth]="true">
  <section class="cadastro">
    <div class="cadastro-layout">
      <aside class="cadastro-menu">
        <div class="tab-shell">
          <p class="tab-shell__title tab-shell__title--destaque">
            <fa-icon [icon]="faTags" class="tab-shell__icon"></fa-icon>
            Versão do Sistema
          </p>
          <ol class="step-tabs" role="tablist">
            <li class="step-tabs__item active">
              <button type="button" class="step-tabs__button" role="tab" aria-selected="true">
                <span class="step-tabs__index">1</span>
                <span class="step-tabs__label">Histórico</span>
              </button>
            </li>
          </ol>
        </div>
      </aside>

      <div class="cadastro-conteudo">
        <section class="version-page">
          <div class="tab-card">
            <div class="tab-card__header">
              <div class="tab-card__title-stack">
                <p class="tab-card__highlight">Versão do Sistema</p>
              </div>
              <div class="version-chip">
                <span>Versão atual</span>
                <strong *ngIf="!carregandoVersao && currentVersion">{{ currentVersion }}</strong>
                <strong *ngIf="carregandoVersao">Carregando...</strong>
                <strong *ngIf="!carregandoVersao && !currentVersion">--</strong>
              </div>
            </div>
            <div class="tab-card__divider"></div>

            <div class="version-header">
              <div class="version-header__info">
                <p class="subtitle">Acompanhe a versão atual e o histórico das últimas entregas.</p>
              </div>
            </div>

            <section class="version-card">
              <div class="card__header">
                <div>
                  <p class="card__eyebrow">Detalhes</p>
                  <h2>Informações da release</h2>
                  <p class="card__subtitle">Número da versão, origem e anotações rápidas.</p>
                </div>
                <div class="card__meta">
                  <p class="meta-label">Identificador técnico</p>
                  <p class="meta-value">{{ currentVersion }}</p>
                </div>
              </div>

              <div class="version-update">
                <div>
                  <p class="version-update__label">Versão atual</p>
                  <p class="version-update__value">{{ currentVersion || '--' }}</p>
                </div>
                <div>
                  <p class="version-update__label">Versão disponível</p>
                  <p class="version-update__value">{{ versaoDisponivel || '--' }}</p>
                </div>
                <div class="version-update__actions">
                  <span class="version-update__feedback" *ngIf="feedbackAtualizacao">{{
                    feedbackAtualizacao
                  }}</span>
                </div>
              </div>

              <div class="release-list">
                <div class="release-list__header">
                  <span>Versão</span>
                  <span>Data/Hora</span>
                  <span>Resumo</span>
                </div>
                <p *ngIf="erroHistorico" class="release-empty">{{ erroHistorico }}</p>
                <p *ngIf="!erroHistorico && carregandoHistorico" class="release-empty">Carregando histórico...</p>
                <p *ngIf="!erroHistorico && !carregandoHistorico && historicoVersoes.length === 0" class="release-empty">
                  Nenhuma atualização registrada.
                </p>

                <article class="release-row" *ngFor="let item of historicoPaginado">
                  <span class="release-row__version">{{ item.versao }}</span>
                  <span class="release-row__date">{{ formatarDataHora(item.criadoEm) }}</span>
                  <ul class="release-row__highlights">
                    <li *ngIf="item.descricao">{{ item.descricao }}</li>
                    <li *ngIf="!item.descricao">Sem resumo informado.</li>
                  </ul>
                </article>

                <div
                  class="release-pagination"
                  *ngIf="!erroHistorico && !carregandoHistorico && historicoVersoes.length > itensPorPagina"
                >
                  <button
                    type="button"
                    class="release-pagination__button"
                    [disabled]="paginaAtual === 1"
                    (click)="voltarPagina()"
                    aria-label="Página anterior"
                  >
                    ◀
                  </button>
                  <span class="release-pagination__status">
                    Página {{ paginaAtual }} de {{ totalPaginas }}
                  </span>
                  <button
                    type="button"
                    class="release-pagination__button"
                    [disabled]="paginaAtual === totalPaginas"
                    (click)="avancarPagina()"
                    aria-label="Próxima página"
                  >
                    ▶
                  </button>
                </div>
              </div>
            </section>
          </div>
        </section>
      </div>
    </div>
  </section>
</app-tela-padrao>
